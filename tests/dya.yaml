config:
  style-completion: "bg:#002222 #ffffff"
  history-size: 5
  verbose: true

---
type: dict
name: static_envs
data:
  - name: dev
    url: dev.internal
  - name: prod
    url: prod.internal

---
type: dynamic_dict
name: dynamic_nodes
priority: 1
command: |
  powershell -NoProfile -Command "Write-Output '[{\"id\": \"node-1\", \"ip\": \"10.0.0.1\"}, {\"id\": \"node-2\", \"ip\": \"10.0.0.2\"}]'"
mapping:
  name: id
  ip: ip

---
type: dynamic_dict
name: cached_items
cache-ttl: 2
command: |
  powershell -NoProfile -Command "Write-Output '[{\"id\": \"item-1\"}]'"
mapping:
  name: id

---
type: command
name: Simple Alias
alias: simple
command: echo simple

---
type: command
name: Dict Consumer
alias: consume $${static_envs.name}
command: echo consuming $${static_envs.url}

---
type: command
name: Dynamic Consumer
alias: dyn $${dynamic_nodes.name}
command: echo dyn $${dynamic_nodes.ip}

---
type: command
name: Complex Structure
alias: complex ${arg1}
command: echo complex ${arg1}
args:
  - alias: --flag
    command: --flag
  - alias: --opt ${val}
    command: --opt ${val}
sub:
  - alias: sub1
    command: sub1
    sub:
      - alias: deep
        command: deep

---
type: command
name: Strict Alias
strict: true
alias: strict
command: echo strict

---
type: command
name: Timeout Cmd
alias: timeout
command: sleep 10
timeout: 10

---
# Single-item dict for testing direct access mode
type: dict
name: single_config
data:
  - key: api_key
    value: secret123
    endpoint: https://api.example.com

---
# Command using direct access mode (dict not in alias, only in command)
type: command
name: Direct Access Test
alias: direct-access
command: echo key=$${single_config.key} value=$${single_config.value} endpoint=$${single_config.endpoint}
helper: Tests direct dict access mode with single-item dict

---
# Command using list mode (dict in alias, same index for command keys)
type: command
name: List Access Test  
alias: list-access $${static_envs.name}
command: echo name=$${static_envs.name} url=$${static_envs.url}
helper: Tests list dict access mode with multi-item dict

---
# ============================================================================
# CHAINING TESTS: dict -> dynamic_dict -> dynamic_dict -> command
# ============================================================================

# Step 1: Base dict with prefix value
type: dict
name: base_prefix
data:
  - prefix: CHAIN

---
# Step 2: First dynamic_dict that references the dict
type: dynamic_dict
name: level1_chain
priority: 3
command: |
  powershell -NoProfile -Command "Write-Output '[{\"value\": \"$${base_prefix.prefix}-LEVEL1\"}]'"
mapping:
  result: value

---
# Step 3: Second dynamic_dict that references the first dynamic_dict
type: dynamic_dict
name: level2_chain
priority: 2
command: |
  powershell -NoProfile -Command "Write-Output '[{\"value\": \"$${level1_chain.result}-LEVEL2\"}]'"
mapping:
  result: value

---
# Step 4: Command that uses the final chained result
type: command
name: Chain Test
alias: chain-test
command: echo $${level2_chain.result}
helper: Tests chaining dict -> dynamic_dict -> dynamic_dict -> command
